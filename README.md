Арсе Морено Оскар Исмаэль М9123-01.04.02пми
Тема "ФОРМИРОВАНИЕ МЕДИЦИНСКОЙ БАЗЫ ЗНАНИЙ ПО ДИАГНОСТИКЕ ЗАБОЛЕВАНИЙ С ИСПОЛЬЗОВАНИЕМ ГЕНЕРАТИВНЫХ НЕЙРОСЕТЕВЫХ МОДЕЛЕЙ".
Руководитель Грибова Валерия Викторовна

# Система извлечения медицинских рекомендаций

Академическая система для анализа и извлечения медицинских рекомендаций из PDF-документов. Использует RAG-подход (Retrieval Augmented Generation), фреймворк для строгой статистической оценки и экспорт данных в структурированный JSON.


## Ключевые возможности

- Обработка PDF: Извлечение текста, интеллектуальная разбивка на части и определение разделов.
- Интеграция RAG: Использование LangChain и векторных баз данных для извлечения информации.
- Экспорт в JSON: Преобразование обработанных данных в структурированный формат.
- Интерфейс командной строки (CLI): Утилита для пакетной обработки файлов.
- Поддержка LLM: Совместимость с моделями OpenAI, Ollama и Hugging Face.
- Система оценки: Скрипты для оценки качества извлечения онтологий и рекомендаций со статистическим анализом.
- Анализ семантической схожести: Оценка с использованием многоязычных эмбеддингов.

## Требования

- Python 3.11 or higher
- UV package manager
- OpenAI API key (for OpenAI models only)
- IACPAAS API credentials (for IACPAAS models)

## Установка

1. Clone the repository:

```bash
git clone https://github.com/DepartmentOfSoftwareEngineeringFEFU/M9123-01.04.02pmi_ArceIsmael
cd M9123-01.04.02pmi_ArceIsmael
```

2. Install dependencies using UV:

```bash
uv sync
```

3. Create a `.env` file in the root directory and add required API keys:

```bash
OPENAI_API_KEY=your_openai_api_key_here
IACPAAS_TOKEN=your_iacpaas_token_here
IACPAAS_MODEL=your_iacpaas_model_name
```

## Архитектура

Система имеет модульную структуру, включающую компоненты для:

    Обработки PDF и текста (PDFProcessor, handlers).
    Интеграции с LLM (LLMClient, LangChainWrapper).
    Оценки качества (OntologyEvaluator и скрипты оценки).

Ключевые зависимости: LangChain, PDFPlumber/PyMuPDF, Typer, Chroma, scikit-learn, sentence-transformers.

## Использование

### CLI

Основной способ использования системы — через CLI:

```bash
# Basic PDF processing
python main.py convert path/to/document.pdf

# Process PDF and export to JSON
python main.py convert path/to/document.pdf --export

# Specify custom output path
python main.py convert path/to/document.pdf --export --output results.json
```

### CLI Options

- `pdf_path`: Путь к PDF-файлу для обработки (обязательно)
- `--export, -e`: Экспорт обработанных данных в файл JSON
- `--output, -o`: Укажите пользовательский выходной путь (по умолчанию — имя PDF-файла с расширением .json)


## Фреймворк оценки

Система включает мощный фреймворк для оценки двух ключевых аспектов:

    Извлечение онтологии: Оценивает, насколько точно модель извлекает структурированные данные (условия, параметры).
    Определение разделов с лечением: Проверяет, правильно ли система находит в документе раздел "Лечение" и его подразделы.

Для запуска оценки необходимо подготовить датасет в формате JSON с эталонной разметкой.

Пример запуска оценки:
```bash
# Оценить модель на датасете для извлечения онтологии
python evaluate_ontology_llm.py evaluate-ontology-model data/validation_50.json
```

Метрики оценки:

- Онтология: Семантическая схожесть (косинусное расстояние), точность (precision), полнота (recall) и F1-мера с 95% доверительными интервалами.
- Разделы лечения: Точность классификации и точность извлечения названий разделов.

Формат вывода

Результат работы системы сохраняется в JSON-файл, содержащий структуру документа с выделенными разделами, общими условиями и извлеченными рекомендациями.
Особенности для научных исследований

- Воспроизводимость
- Статистическая значимость
- Детальное логирование
